# GibleTron: An Interactive Twitch Overlay Experience

## What is GibleTron?

GibleTron is an interactive real-time overlay game for Twitch streams that transforms viewer engagement into collaborative visual art. Viewers contribute through chat, subscriptions, follows, cheers, and raids to collectively fill a rotating 3D sphere with their territories. The game combines real-time interactivity with long-term progression, creating moments of celebration while building persistent player recognition.

It's a "player vs. sphere" game where the sphere always wins eventually, but every viewer's contribution is visible, tracked, and rewarded with visual prominence and a tier ranking that persists forever.

---

## The Visual Experience

### The Hexasphere

At the center of every stream sits a mesmerizing 3D rotating sphere divided into hexagonal tiles. This isn't just any sphere—it's mathematically optimized to maximize tile uniformity and visual appeal.

**Visual breakdown:**

- **Default configuration**: 92 tiles arranged across the sphere surface
- **Continuous rotation**: The entire sphere rotates at a configurable speed
- **Real-time updates**: As viewers contribute, tiles fill with their color and username
- **Unfilled state**: Empty tiles glow with cyan edges, inviting contribution

### Contributor Stars

Each player who claims their first tile receives a **permanent star** that hovers above that tile. This star never disappears—it's a lasting monument to that viewer's participation.

**Star Evolution:**
As a viewer claims more tiles and reaches higher tiers, their star grows and shines brighter:

| Tier     | Threshold   | Visual Upgrades                            |
| -------- | ----------- | ------------------------------------------ |
| None     | 0 tiles     | Base star                                  |
| Bronze   | 25 tiles    | Glowing halo, 10% larger                   |
| Silver   | 75 tiles    | Pulsing animation, 20% larger              |
| Gold     | 150 tiles   | Golden edges, 30% larger                   |
| Platinum | 300 tiles   | Platinum edges, 40% larger                 |
| Diamond  | 500 tiles   | Blue diamond edges, 50% larger             |
| Champion | 1000+ tiles | Crown above star, 80% larger, intense glow |

Stars are **geosynchronous**—they rotate with the sphere, maintaining their position above each viewer's first tile.

### Chat Rings

When a viewer sends a chat message, it transforms into a 3D text ring that orbits the sphere. The username and message appear as colorful text arranged in an arc, spawning from that viewer's star position.

**Effect parameters:**

- Message text orbits at variable speed and radius
- Each message rotates differently, creating visual variety
- Text glows and fades out after 5 seconds
- Multiple messages orbit simultaneously, creating a dynamic halo of communication

### The Star Core

Deep within the sphere sits a breathing, glowing core. This is the heart of the game—a visual representation of the sphere's progression.

**Visual composition:**

- **Central sphere**: Glowing core with animated breathing (pulsing) effect
- **Orbital corona**: 20-500 particles (depending on fill level) orbit in atom-like patterns
- **Light trails**: Particles leave glowing trails as they move
- **Reactive progression**: As the sphere fills, the core's glow intensifies

When the sphere reaches 80% full, the core shifts to a white-hot glow, signaling that victory is near.

### Beam Effects

When a viewer claims a tile, a visual beam fires from their star to the tile, providing instant feedback. The tile then animates into existence with a satisfying scale animation.

---

## How Viewers Participate

### Contribution Methods

GibleTron accepts contributions through multiple Twitch engagement channels, each providing a different number of points:

#### 1. Chat Messages (1 point per message)

- **Most accessible**: Lowest barrier to entry
- **Most frequent**: Keeps the game active throughout the stream
- Every single message fills one tile (unless the sphere is already full)

#### 2. Channel Follows (5 points per follow)

- **New followers only**: Each viewer can only grant follow points once
- **Instant gratification**: New followers immediately see their tile fill
- Creates welcome experience for fresh viewers

#### 3. Subscriptions

- **Tier 1 Sub**: 10 points
- **Tier 2 Sub**: 20 points
- **Tier 3 Sub**: 50 points
- **Resubs & Gift Subs**: Count fully toward the contributor
- **Most prestigious**: Highest value single contributions

#### 4. Cheer with Bits

- **Formula**: 0.1 points per bit (minimum 1 point)
- **Example**: 100 bits = 10 tiles, 500 bits = 50 tiles
- **Flexible**: Viewers choose their commitment level

#### 5. Raids

- **Formula**: 0.5 points per viewer (minimum 5 points)
- **Example**: 50-viewer raid = 25 tiles, 100-viewer raid = 50 tiles
- **Community moments**: Creates big visual updates during stream transitions

#### 6. Pico Coin Redemptions

The streamer can create custom pico coin rewards (Twitch channel points). The system includes pre-configured defaults:

- **Claim 2 Tiles**: 500 pico coins
- **Claim 4 Tiles**: 1000 pico coins
- **Claim 8 Tiles**: 2000 pico coins
- **Claim 16 Tiles**: 4000 pico coins

Streamers can also create custom rewards that fill a configurable number of tiles.

---

## Territory Control & Growth Strategy

GibleTron employs an intelligent tile placement algorithm that creates visually interesting territorial patterns centered around each player's **base tile**.

### The Base System

Every contributor receives a **base tile** when they first participate. This tile is:

- Placed as far as possible from existing territories
- The anchor point for their empire
- The tile that matters for win conditions

The base is the heart of each player's territory. All strategic tile placement revolves around growing outward from this base.

### Tile Placement Strategy

Once a viewer has their base, subsequent contributions follow a probabilistic strategy:

**60% of the time: Connected to Base**

- New tiles expand **directly adjacent** to existing tiles connected to their base
- Grows the player's connected empire outward
- These tiles count toward the win condition

**40% of the time: Random Outposts**

- New tiles appear anywhere on the unclaimed sphere
- Creates scattered territories and surprise expansions
- Adds unpredictability—but outposts don't count for winning!

**Strategic implications:**

- Players want connected tiles, not scattered outposts
- The 60/40 split creates tension between building an empire and random expansion
- Disconnected tiles are still valuable for brain cell progression, just not for stage victory

---

## The Stage System

GibleTron runs in **5 stages**, each building on the last. Every stage has a winner, and Stage 5 culminates in something extraordinary.

### Stage Progression

| Stage | Complexity | Description                            |
| ----- | ---------- | -------------------------------------- |
| 1     | Simple     | Basic tile claiming, learning the game |
| 2     | Growing    | Competition heats up                   |
| 3     | Strategic  | Territory battles intensify            |
| 4     | Climactic  | Final push for dominance               |
| 5     | FINALE     | Something crazy happens                |

Each stage completes when all tiles are filled. The sphere resets between stages, but **brain cells persist**.

### Winning a Stage

The **winner** of each stage is the player with the **most tiles connected to their base tile**.

**What counts:**

- Only tiles that form an unbroken chain back to your base
- Random outposts (disconnected tiles) don't count
- Even if you have 50 total tiles, only your connected blob matters

**What happens when you win:**

- Recognition on the completion screen
- Stage winner title
- (More rewards TBD for each stage)

### Stage 5: The Finale

When Stage 5 completes, something **crazy happens**. This is the climax of the entire game cycle—a moment of spectacle that celebrates everyone who participated across all 5 stages.

_(The exact nature of the Stage 5 event is intentionally mysterious.)_

---

## Player Progression: The Brain Cell Economy

GibleTron includes a **brain cell economy** that persists across all games, stages, and stream sessions. Brain cells are the central currency of the game.

### The Brain Cell Economy

**Brain cells are player currency.** They are:

- **Permanent**: Once earned, never deleted
- **Cumulative**: Only grow, never shrink
- **Persistent**: Survive game resets, stage transitions, stream restarts, server reboots

Every tile a viewer ever claims—whether connected to their base or a random outpost—earns them **brain cells**. This is the true measure of a player's investment in the game.

**Economy implications:**

- Stage wins are glory; brain cells are wealth
- A player might lose every stage but still be the richest in brain cells
- Tier progression is tied to brain cells, not stage performance

The brain cell tracker is saved to the database and survives:

- Stage resets (5 per cycle)
- Game cycle restarts
- Stream endings and restarts
- Server restarts
- Configuration changes

A viewer who reaches 1000 brain cells maintains that rank forever—and the game will visually celebrate it every time they're on screen.

### Tier Progression

**Tier milestones unlock visual enhancements:**

1. **Bronze (25 tiles)**: First major milestone—stars begin to glow
2. **Silver (75 tiles)**: Pulsing animation indicates serious commitment
3. **Gold (150 tiles)**: Golden edges on contributed tiles
4. **Platinum (300 tiles)**: Platinum coloring distinguishes top contributors
5. **Diamond (500 tiles)**: Rare achievement with blue diamond edges
6. **Champion (1000+ tiles)**: Legendary status with crown above star

### Tier Visual Rewards

Beyond size and glow, tiers unlock **3D extrusion height** on tiles:

- **Bronze**: Tiles extrude 1 unit above sphere surface
- **Silver**: 2 units
- **Gold**: 3 units
- **Platinum**: 4 units
- **Diamond**: 5 units
- **Champion**: 6 units

The result: Champion territories stand out dramatically on the sphere, creating a visual hierarchy of brain cell accumulation.

### Star Labels

When a player interacts during active game (claiming new tiles), their username appears above their star for 4 seconds, then fades over 1 second. This creates fleeting recognition moments that celebrate the contributor.

---

## Game States & Win Conditions

### Stage Flow

**Active Stage State:**

- Sphere accepts contributions
- Tiles fill in real-time as viewers interact
- Stars spawn for new players (base tile assigned)
- Chat rings orbit
- Core pulses and reacts to progress
- Current stage number displayed

**Stage Completion State:**
When all tiles are filled, the stage transitions to celebration:

**Stage Completion Screen displays:**

- **Stage number**: Which stage just completed (1-5)
- **Stage winner**: Player with most tiles connected to their base
- **Duration**: Total time to fill the sphere
- **Contributor count**: How many unique viewers participated
- **Top 5 Leaderboard**: Shows players ranked by connected tiles (not total tiles)
  - Rank, username, color indicator, connected tile count
  - Created fresh for each stage

**Stage Transition:**
After stages 1-4 complete:

- Winner is celebrated
- Sphere resets for next stage
- Bases are cleared (players get new bases next stage)
- Brain cells persist

**After Stage 5:**

- Final winner celebrated
- **Something crazy happens** (the big payoff)
- Full cycle complete
- Option to start new 5-stage cycle

---

## The Tech Stack

GibleTron is built on modern, proven technologies optimized for real-time streaming overlays:

### Frontend (Overlays)

**React Three Fiber + Three.js**

- Renders the 3D sphere, stars, rings, and effects
- Handles real-time visual updates
- Optimized for 60fps on consumer GPUs

**React + Next.js**

- Component structure for overlay pages
- Server-Sent Events (SSE) for real-time updates
- Live configuration without page reloads

### Backend

**Next.js 15 API Routes**

- Handles Twitch event webhooks
- Provides SSE event streaming
- Manages configuration and game state

**Bun Runtime**

- Fast TypeScript execution
- All code written in TypeScript for type safety

### Data Persistence

**SQLite** (via `bun:sqlite`)

- Player data: brain cells, tiers, progression
- Game state: stages, tiles, contributors, bases
- Trades & Wagers: active offers, history
- Archives: completed game records
- ACID transactions for data integrity

**JSON Files** (configs only)

- Overlay settings (chat rings, star core, visuals)
- Game configuration (sphere, contribution values)
- Human-readable, dashboard-editable

### Twitch Integration

**Twurple**

- Industry-standard Twitch API client library
- Handles OAuth authentication
- Real-time event listening via EventSub (WebSocket)
- IRC chat message handling

### Real-Time Communication

**Server-Sent Events (SSE)**

- One-way streaming from server to overlays
- Native browser support (no polling)
- Automatic reconnection
- Low latency, high scalability

### Deployment Model

**Local-only architecture:**

- Runs on a single Ubuntu machine (the streaming PC)
- No cloud services required
- No deployment pipeline
- Zero dependencies on external infrastructure

This architecture ensures that every frame, every tile fill, and every animation is under the streamer's complete control, with zero latency between Twitch event and visual update.

---

## Why GibleTron Works

### For Viewers

- **Instant feedback**: Chat message → tile fill (sub-200ms latency)
- **Lasting impact**: Your contribution is visible forever in the brain cell tier system
- **Low barrier**: Chat provides effortless entry point
- **Variety of engagement**: Multiple ways to contribute based on commitment level

### For Streamers

- **Engagement driver**: Natural incentive for chat, follows, subs, and raid-backs
- **Visual spectacle**: Impressive overlay that fills screen space
- **Retention**: Viewers check back to see their tier progression
- **Customizable**: Tweakable values for point amounts, tier thresholds, colors, animation speeds

### For the System

- **Deterministic**: No randomness in core mechanics, fully predictable
- **Fair**: Equal tile size for all viewers, placement algorithm creates visual balance
- **Performant**: 3D sphere scales to 1000+ contributors without slowdown
- **Extensible**: Foundation for future overlays, effects, and game variations

---
